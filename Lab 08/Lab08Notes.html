<!-- Slide:  91 

Sources:
- https://moment.github.io/luxon/
- https://moment.github.io/luxon/#/install
- https://moment.github.io/luxon/#/why
- https://moment.github.io/luxon/#/tour
- https://moment.github.io/luxon/
- https://moment.github.io/luxon/api-docs/
- https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date
Stack Overflow discussions on age calculation accuracy

Months are 1-indexed (January = 1) instead of 0-indexed like native JS
Built-in formatting methods
Better timezone handling
Chainable methods for date manipulation

- Notes:
DateTime.now() - gets current date/time
DateTime.fromISO() - creates date from ISO string
diff() - calculates difference between dates
toFormat() - formats dates for display
setZone() - changes timezone

- Questions I Had During Development
Question 1: How do I calculate age accurately?
Initially tried using simple date subtraction, but realized this doesn't account for leap years and varying month lengths. Found that using diff() with years, then months, then days gives more accurate results.
Question 2: Why use startOf('day')?
Research showed this removes time components, so we only compare dates, not specific times. Important for birthday calculations.
Question 3: How to handle invalid dates?
Learned that Luxon provides isValid property to check if date parsing was successful. Always check this before performing calculations.

- JavaScript Code:
My code is organized into separate functions for each problem, making it easier to understand and debug.
Setup:

I create a reference to Luxon's DateTime class for easier use
The calculateAll() function runs all calculations when called

Problem 1 - Days Between Dates:
I use DateTime.fromISO() to convert the HTML date input to a Luxon date object. The startOf('day') method removes time components so we only compare dates. Then diff() calculates the difference in days.
Problem 2 - Detailed Age Calculation:
This was the trickiest part. I calculate years first, then add those years to the birth date to find the "anchor" date. Then I calculate remaining months from that anchor, and finally remaining days. This gives accurate results that account for leap years and varying month lengths.
Problem 3 - Closest Date:
I calculate the absolute difference between now and each date using Math.abs(). The smaller difference indicates the closer date.
Problem 4 - Date Comparison:
Simple comparison using JavaScript's built-in date comparison operators. Luxon DateTime objects can be compared directly.
Problem 5 - London Time:
I use setZone() to convert the current time to London timezone, then toFormat() to display it in a readable format.
Error Handling:
Throughout the code, I check isValid property to ensure dates were parsed correctly before performing calculations.
Event Listeners:
I added change event listeners to all inputs so results update automatically when the user changes any date.


------------------------------------ ------------------------------------ ------------------------------------ 
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab #8</title>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.5.0/build/global/luxon.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        .input-group { 
            margin-bottom: 15px; 
        }
        label { 
            display: block; 
            margin-bottom: 5px; 
            font-weight: bold; 
        }
        input[type="date"] { 
            padding: 8px; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
        }
        .result { 
            background: #f5f5f5; 
            padding: 10px; 
            border-radius: 4px; 
            margin: 10px 0; 
        }
        button { 
            background: #007bff; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
        }
        button:hover { 
            background: #0056b3; 
        }
    </style>
</head>
<body>
    <h1>Date Calculator</h1>
    
    <div class="input-group">
        <label for="birthdate">Your Birthdate:</label>
        <input type="date" id="birthdate" value="1993-12-07">
    </div>
    
    <div class="input-group">
        <label for="dateA">Date A:</label>
        <input type="date" id="dateA" value="2025-09-01">
    </div>
    
    <div class="input-group">
        <label for="dateB">Date B:</label>
        <input type="date" id="dateB" value="2025-10-15">
    </div>
    
    <button onclick="calculateAll()">Calculate All Results</button>
    
    <div id="results">
        <h2>Results:</h2>
        <div id="result1" class="result"></div>
        <div id="result2" class="result"></div>
        <div id="result3" class="result"></div>
        <div id="result4" class="result"></div>
        <div id="result5" class="result"></div>
    </div>

    <script>
        const DateTime = luxon.DateTime;
        
        function calculateAll() {
            const birthdate = document.getElementById('birthdate').value;
            const dateA = document.getElementById('dateA').value;
            const dateB = document.getElementById('dateB').value;
            
            calculateDaysBetween(birthdate);
            
            calculateDetailedAge(birthdate);
            
            findClosestDate(dateA, dateB);
            
            compareTwoDates(dateA, dateB);
            
            showLondonTime();
        }
        
        function calculateDaysBetween(birthdateISO) {
            const today = DateTime.now().startOf('day');
            const birth = DateTime.fromISO(birthdateISO).startOf('day');
            
            if (!birth.isValid) {
                document.getElementById('result1').innerHTML = '<strong>Problem 1:</strong> Invalid birthdate';
                return;
            }
            
            const daysDiff = today.diff(birth, 'days').days;
            document.getElementById('result1').innerHTML = 
                `<strong>Problem 1:</strong> ${Math.floor(daysDiff)} days between your birthdate and today`;
        }
        
        function calculateDetailedAge(birthdateISO) {
            const today = DateTime.now().startOf('day');
            const birth = DateTime.fromISO(birthdateISO).startOf('day');
            
            if (!birth.isValid) {
                document.getElementById('result2').innerHTML = '<strong>Problem 2:</strong> Invalid birthdate';
                return;
            }
            
            const years = Math.floor(today.diff(birth, 'years').years);
            
            const afterYears = birth.plus({ years: years });
            const months = Math.floor(today.diff(afterYears, 'months').months);
            
            const afterMonths = afterYears.plus({ months: months });
            const days = Math.floor(today.diff(afterMonths, 'days').days);
            
            document.getElementById('result2').innerHTML = 
                `<strong>Problem 2:</strong> ${years} years, ${months} months, and ${days} days old`;
        }
        
        function findClosestDate(dateAISO, dateBISO) {
            const now = DateTime.now();
            const dateA = DateTime.fromISO(dateAISO);
            const dateB = DateTime.fromISO(dateBISO);
            
            if (!dateA.isValid || !dateB.isValid) {
                document.getElementById('result3').innerHTML = '<strong>Problem 3:</strong> Invalid date(s)';
                return;
            }
            
            const diffA = Math.abs(now.diff(dateA, 'milliseconds').milliseconds);
            const diffB = Math.abs(now.diff(dateB, 'milliseconds').milliseconds);
            
            let closest;
            if (diffA < diffB) {
                closest = dateA.toISODate() + ' (Date A)';
            } else if (diffB < diffA) {
                closest = dateB.toISODate() + ' (Date B)';
            } else {
                closest = 'Both dates are equally close';
            }
            
            document.getElementById('result3').innerHTML = 
                `<strong>Problem 3:</strong> Closest to today: ${closest}`;
        }
        
        function compareTwoDates(dateAISO, dateBISO) {
            const dateA = DateTime.fromISO(dateAISO);
            const dateB = DateTime.fromISO(dateBISO);
            
            if (!dateA.isValid || !dateB.isValid) {
                document.getElementById('result4').innerHTML = '<strong>Problem 4:</strong> Invalid date(s)';
                return;
            }
            
            let comparison;
            if (dateA < dateB) {
                comparison = 'Date A is before Date B';
            } else if (dateA > dateB) {
                comparison = 'Date A is after Date B';
            } else {
                comparison = 'Date A and Date B are the same';
            }
            
            document.getElementById('result4').innerHTML = 
                `<strong>Problem 4:</strong> ${comparison}`;
        }
        
        function showLondonTime() {
            const londonTime = DateTime.now().setZone('Europe/London');
            const formatted = londonTime.toFormat('MMMM dd, yyyy - hh:mm:ss a');
            
            document.getElementById('result5').innerHTML = 
                `<strong>Problem 5:</strong> Current London time: ${formatted}`;
        }
        
        calculateAll();
        
        document.getElementById('birthdate').addEventListener('change', calculateAll);
        document.getElementById('dateA').addEventListener('change', calculateAll);
        document.getElementById('dateB').addEventListener('change', calculateAll);
    </script>
</body>
</html>